<!-- templates/reports/reports_list.html -->
{% extends "reports/base_reports.html" %}

{% block reports_content %}
<!-- عنوان الصفحة -->
<h3 class="mb-4">All Reports</h3>

<!-- قسم التحكم بالأزرار والفلاتر -->
<div class="row mb-3">
  <!-- الفلترة حسب الفئة -->
  <div class="col-md-6">
    <div class="btn-group">
      <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
        Filter by Report Category
      </button>
      <ul class="dropdown-menu">
        <li><a class="dropdown-item" href="{% url 'reports_by_category' 'personal' %}">Personal Information Reports</a></li>
        <li><a class="dropdown-item" href="{% url 'reports_by_category' 'guardian' %}">Guardian Information Reports</a></li>
        <li><a class="dropdown-item" href="{% url 'reports_by_category' 'health' %}">Health Information Reports</a></li>
        <li><a class="dropdown-item" href="{% url 'reports_by_category' 'academic' %}">Academic Information Reports</a></li>
      </ul>
    </div>
  </div>

  <!-- الأزرار العامة (تصدير، توليد، استيراد...) -->
  <div class="col-md-6 text-md-end mt-3 mt-md-0">
    <a href="{% url 'export_reports_pdf_view' %}" class="btn btn-danger me-2">Export PDF</a>
    <a href="{% url 'export_reports_csv_view' %}" class="btn btn-warning me-2">Export CSV</a>
    <a href="{% url 'auto_generate_reports' %}" class="btn btn-primary me-2">Generate Reports Automatically</a>
    <a href="{% url 'generate_report_dropdown' %}" class="btn btn-success me-2">Generate Report by Selecting Student</a>
    <a href="{% url 'import_reports_csv_view' %}" class="btn btn-secondary">Import CSV</a>
  </div>
</div>

<!-- جدول عرض التقارير -->
<div class="table-responsive">
  <table class="table table-striped table-hover align-middle">
    <thead class="table-dark">
      <tr>
        <th>Student</th>
        <th>Report Category</th>
        <th>Report Type</th>
        <th>Status</th>
        <th>Generated At</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for report in reports %}
      <tr>
        <td>{{ report.student.full_name }}</td>
        <td>{{ report.get_category_display }}</td>
        <td>{{ report.report_type }}</td>
        <td>{{ report.status }}</td>
        <td>{{ report.generated_at }}</td>
        <td>
          <a href="{% url 'view_report' report.id %}" class="btn btn-sm btn-info">View</a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center">No reports found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
